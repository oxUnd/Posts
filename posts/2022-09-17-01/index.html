<!doctype html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous">
  <link href="https://www.orrafy.com/css/reset.css?v=fatal: detected dubious ownership in repository at &#39;/github/workspace&#39;
To add an exception for this directory, call:

	git config --global --add safe.directory /github/workspace" rel="stylesheet">
  <link href="https://www.orrafy.com/css/site.css?v=fatal: detected dubious ownership in repository at &#39;/github/workspace&#39;
To add an exception for this directory, call:

	git config --global --add safe.directory /github/workspace" rel="stylesheet">
  <link rel="preload" href="https://www.orrafy.com/fonts/blockzone-webfont.woff2" as="font" type="font/woff2" crossorigin>
  
</head>
<body>
  <header id="preamble" class="status">
    <div class="logo">
      <a href="/">
        <img src="https://0.gravatar.com/avatar/6187fb849f337554f1515012aedd06d55365e8ac6f170cbadfaaf94d5e3790cd?s=80" class="avatar" alt="My icon."/>
      </a>
      <a href="/"><h2>OxUnd. </h2></a>
      <div id="social">
        <a title="dmacvicar on Github" href="https://github.com/oxund">
          <i id="github-icon" class="fa-brands fa-github"></i>
      	</a>
        <a title="RSS feed" id="atom" href="https://www.orrafy.com/posts/rss.xml">
          <i id="rss-icon" class="fa-solid fa-rss"></i>
        </a>
    </div>
    <sub>keep simple and stupid</sub>
 </header>
 <main id="main">
 
<h1>&#34;Emacs使用以及简单优化&#34;</h1>
<div class="date">17 Sep 2022</div>
<div class="content">
  
<section id="outline-container-2022-09-17-01" class="outline-2">
<h2 id="2022-09-17-01">2022-09-17-01</h2>
<div class="outline-text-2">
<p>
过去了几天，一直尝试在用 emacs
做想做的事情，写想写的东西。使用方法大概基本掌握了，学习曲线确实还是有的。好在
elisp
是个不错的语言，能够完成几乎想完成的大部分事情。就这样，写了一套自己用的配置，以及熟悉了一些好用的插件。
</p>

<p>
今天，对加载 <code>.el</code> 配置进行大量的优化，基本都是靠 emacs 自己的
bytecode。整体效率有提升，但没有做打点统计时间的优化程度。
</p>

<p>
通过函数 <i>byte-compile-file</i> 能够把 <code>.el</code> 编译成 <code>.elc</code> 字节码文件，加载
<code>.elc</code> 不再需要编译，性能有个不错的提升，肉眼可见。
</p>

<p>
尝试美化
=*Completions*=，找了几个插件，都没有找到合适、简单、易用的方法，暂时作罢。就是这样，折腾编辑器就想把每个区域都进行定制，尝试定制的乐趣。
</p>

<p>
突然打开 <code>vim</code> 发现以前常用的，快捷键都快生疏了。后面可能在 <code>emacs</code>
模式下尝试用 vim 的快捷键，但首要任务先得把经典按键学习熟练，用好。
</p>

<pre class="example" id="orgeb6f064">
#+BEGIN_SRC emacs-lisp
  (defun load-b (file)
    (if (file-exist-p (file-name-with-extension file ".elc"))
        (load file) ;; .elc .el ...
      (progn
        (byte-compile-file (file-name-with-extension file ".el"))
        (load file))))
  ;; example
  (load-b "path/to/.el/file")
#+END_SRC
</pre>

<p>
加载插件文件时
</p>

<ul class="org-ul">
<li><code>load-b</code> 加载自定义的插件或者配置文件，不使用 <code>require</code></li>
<li><code>use-package</code> 加载第三方扩展</li>
</ul>

<p>
基本思路如果没有编译成字节码，就先编译后加载，如果已经有 <code>.elc</code> 文件直接
<code>load=。其中有个问题是当我们进行配置变更时希望能够重新编译，其中
EmacsWiki 给了一个明确的方法。在保存 =.el</code>
文件时进行编译，这样能满足大部分的诉求。但当改坏了怎么办，或者由于不当操作导致无法重新编译怎么办？应该有很好的办法，但我现在没有时间做更多的研究，暂时就用最粗暴的方式。删除除了
<code>elpa</code> 文件夹下其他所有 <code>.elc</code> 文件。
</p>

<pre class="example" id="orgf2177fe">
#+BEGIN_SRC bash
  find ./a ./b ./c -name '*.elc' | xargs rm
#+END_SRC
</pre>

<p>
为了后续方便，使用 <code>Makefile</code>
</p>

<pre class="example" id="org2d6ec44">
#+BEGIN_SRC makefile
  .PHONY: clean
      clean:
          find ./a ./b ./c -name '*.elc' | xargs rm
  .PHONY: all
      all:
          echo "Nothing...."
#+END_SRC
</pre>

<p>
在出现错误时 <code>make clean</code> 即可。
</p>

<p>
简单折腾，使用 emacs 随时面临大折腾的可能，但学习面向 character
编程的语言，确实感觉不错。
</p>

<p>
&#x2026;&#x2026;
</p>

<p>
突然看了一下，=load-b=
写得有点啰嗦，长时间没有写代码就会这样，写得开始“挫”了。
</p>

<pre class="example" id="orgb627690">
#+BEGIN_SRC emacs-lisp
  (defun load-b (file)
    (unless (file-exist-p (file-name-with-extension file ".elc"))
      (byte-compile-file (file-name-with-extension file ".el")))
    (load file))
#+END_SRC
</pre>
</div>
</section>

</div>

 </main>

<hr/>
 
 <p class='disclaimer'></p>

  <p>Last updated 17 Sep 2025. Built with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 29.4 (<a href="https://orgmode.org/">Org</a> mode 9.6.15). <a href="https://www.orrafy.com/readme.html">Details</a>.</p>
</body>
</html>
